<div class="flex  justify-between items-center sticky top-0 bg-white z-[1000] w-full px-2 max-sm:pr-3 py-4">
  <!-- Left: Sidebar Toggle and Title -->
  <div class="flex items-center gap-1.5">
    <button (click)="toggleSideBar()">
      <img src="assets/images/SideBar.png" alt="Menu" class="w-10 h-10 object-contain hover:bg-primary-tint rounded" />
    </button>
    <span class="inline text-xl font-bold text-primary">Quizine</span>
  </div>

  <!-- Center: Search (hidden for mobile) -->
  <div class="hidden xs:flex flex-1 justify-center relative">
    <input
      type="text"
      placeholder="Recherche"
      class="bg-gray-200 h-10 w-[75%] rounded-lg p-2 focus:outline-none focus:border-primary min-w-0"
      [value]="searchTerm"
      (input)="onSearchChange($event)"
      (focus)="searchDropdownOpen = true"
      (keydown.escape)="searchDropdownOpen = false"
    />
    
    <!-- Search Dropdown -->
    <div *ngIf="searchTerm && searchDropdownOpen" (mousedown)="$event.stopPropagation()" class="absolute w-[75%] top-10 bg-white border border-gray-300 rounded-lg shadow-lg z-[1100]">
      <ul class="max-h-80 overflow-y-auto">
        <li
          *ngIf="filteredQuizList.length === 0"
          class="px-4 py-2 text-gray-400 cursor-default"
        >
          Aucun quiz trouvé
        </li>
        <li
          *ngFor="let quiz of filteredQuizList"
          (click)="gotoQuiz(quiz.id)"
          class="px-4 py-2 hover:bg-gray-100 cursor-pointer"
        >
          {{ quiz.nom }}
        </li>
      </ul>
    </div>
  </div>

  <!-- Right: Actions -->
  <div class="flex items-center justify-end gap-4">
    <!-- Mobile: round + button, Desktop: full button -->
    <button
      class="bg-primary text-white rounded-xl w-10 h-10 flex items-center justify-center text-2xl md:hidden"
      (click)="gotoCreateQuiz()"
      aria-label="Créer un quiz"
    >
      +
    </button>
    <button
      class="hidden md:inline-block bg-primary text-white px-4 py-2 rounded-lg text-base"
      (click)="gotoCreateQuiz()"
    >
      + Créer un quiz
    </button>

    <div class="relative" (mouseleave)="profileDropdownOpen = false" (mouseenter)="profileDropdownOpen = true">
      <button (click)="profileDropdownOpen = !profileDropdownOpen">
        <img src="assets/images/ProfileLogo.png" alt="Profil" class="w-10 h-10 object-contain" />
      </button>
      <!-- Transparent Bridge -->
      <div
        *ngIf="profileDropdownOpen"
        class="absolute right-0"
        style="top:40px; height:8px; width:48px; background:transparent;"
        (mouseenter)="profileDropdownOpen = true"
        (mouseleave)="profileDropdownOpen = false"
        ></div>
        <!-- (mousedown)="$event.stopPropagation()" -->
      <div
        *ngIf="profileDropdownOpen"
        (mousedown)="$event.stopPropagation()"
        (keydown.escape)="profileDropdownOpen = false"
        class="absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50"
      >
        <button
          (click)="gotoProfile(); profileDropdownOpen = false"
          class="block w-full text-left px-4 py-2 hover:bg-gray-100"
        >
          Profil
        </button>
        <button
          (click)="logout(); profileDropdownOpen = false"
          class="block w-full text-left px-4 py-2 text-red-500 hover:bg-red-500 hover:text-white"
        >
          Se déconnecter
        </button>
      </div>
    </div>
    <!-- <button (click)="gotoProfile()">
      <img src="assets/images/ProfileLogo.png" alt="Profil" class="w-10 h-10 object-contain" />
    </button>

    <button
      (click)="logout()"
      class="flex items-center gap-2 text-red-500 hover:text-white hover:bg-red-500 transition px-3 py-2 rounded-lg font-medium"
    aria-label="Se déconnecter">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h4a2 2 0 012 2v1" />
      </svg>
      <span>Se déconnecter</span>
    </button> -->
  </div>
</div>